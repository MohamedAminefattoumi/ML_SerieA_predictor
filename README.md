## Serie A Match Outcome Prediction

Predict Serie A match results (W/D/L) using pre-match rolling averages and machine learning.

### What this project does
- **Trains** multiple models with cross-validation and picks the best one.
- **Computes pre-match features** (rolling averages for both teams up to a round).
- **Saves** the best pipeline to `best_model.pkl`.
- **Predicts** outcomes for a future match via a simple CLI or Python API.

### Project structure
```
main.py                 # Build features, train via GridSearchCV, save best_model.pkl
predict.py              # Predict W/D/L using saved model (CLI + Python API)
Datavisualisation.py    # Exploratory plots for engineered features
streamlite.py           # Simple Streamlit app to explore datasets
Serie_A.csv             # Raw dataset (input)
Serie_A_features.csv    # Engineered features (generated by main.py)
best_model.pkl          # Trained model pipeline (generated by main.py)
```

## Getting started

### 1) Environment setup
```bash
python -m venv .venv
# Windows PowerShell
. .venv\Scripts\Activate.ps1

pip install -r requirements.txt
```

### 2) Train the model (optional)
`main.py` computes pre-match averages, runs a model search (RandomForest, SVM, XGBoost, KNN, Naive Bayes), and saves the best pipeline to `best_model.pkl`.
```bash
python main.py
```

### 3) Predict a match via CLI
```bash
python predict.py
# Follow the prompts, e.g.:
# Enter the team: Napoli
# Enter the opponent: Milan
# Enter the venue (Home/Away): Home
# Enter the season (e.g., 2025): 2025
# Enter the round value (e.g., Matchweek 10 or 10): Matchweek 10
```

### 4) Predict a match via Python API
```python
from predict import predict_match_result

label, probas = predict_match_result(
    team="Napoli",
    opponent="Milan",
    venue="Home",           # or "Away"
    season=2025,
    round_value="Matchweek 10"  # or integer like 10
)
print(label)       # e.g., 'W', 'D', or 'L'
print(probas)      # class probabilities if available
```

### 5) Optional: Explore data with Streamlit
```bash
streamlit run streamlite.py
```

## Notes on data and features
- `main.py` constructs pre-match rolling averages for: `GF`, `GA`, `xG`, `xGA`, and `Poss` for both teams.
- The model uses engineered features plus categorical encodings for `Season`, `Round`, `Team`, `Opponent`, and `Venue`.
- `predict.py` reproduces the same preprocessing to ensure consistency at inference time and supports mild fuzzy matching on team names and flexible round inputs like `10` or `Matchweek 10`.

## Reproducibility
- A fixed `random_state` is used in training where applicable.
- Ensure the same `Serie_A.csv` used during training is also available for inference, as pre-match averages depend on historical data.



